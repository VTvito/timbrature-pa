# â° Timbra PA

[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](https://opensource.org/licenses/MIT)
[![PWA Ready](https://img.shields.io/badge/PWA-Ready-brightgreen.svg)](https://web.dev/progressive-web-apps/)
[![Made in Italy](https://img.shields.io/badge/Made%20in-Italy%20ğŸ‡®ğŸ‡¹-green.svg)](#)
[![Offline First](https://img.shields.io/badge/Offline-First-orange.svg)](#)
[![No Backend](https://img.shields.io/badge/Backend-Non%20richiesto-purple.svg)](#)

> ğŸ“± **L'app gratuita per tracciare le ore di lavoro dei dipendenti pubblici italiani.**  
> Funziona offline, si installa come un'app nativa, i tuoi dati restano solo sul tuo dispositivo.

![Screenshot App](docs/screenshot.svg)

---

## ğŸ¯ PerchÃ© Timbra PA?

| âŒ Altre app | âœ… Timbra PA |
|---|---|
| Richiedono account | **Nessuna registrazione** |
| Dati su server esterni | **Dati solo sul TUO dispositivo** |
| Abbonamento mensile | **100% gratuita, per sempre** |
| Progettate per il settore privato | **Pensata per la PA italiana (CCNL Funzioni Locali)** |
| Calcoli manuali | **36h/settimana calcolate in automatico** |

---

## âœ¨ FunzionalitÃ 

### ğŸ“Š Calcolo automatico ore
- **Target settimanale 36 ore** â€” standard CCNL Funzioni Locali
- **Saldo positivo/negativo** aggiornato in tempo reale
- **Pausa pranzo 30 min** dedotta automaticamente (tutti i giorni, se ore lorde > 6h)
- **Settimane ISO 8601** â€” navigazione veloce avanti/indietro

### ğŸ  Smart Working & Assenze
- **Lavoro Agile**: registra 7h 30m (Lunâ€“Gio) o 6h (VenerdÃ¬) con un tocco
- **Assenze**: traccia ferie, permessi, malattia
- **Entrate/Uscite multiple** nello stesso giorno (pause reali considerate)

### ğŸ“… Suggerimento uscita venerdÃ¬
- L'app calcola gli extra accumulati da lunedÃ¬ a giovedÃ¬
- VenerdÃ¬ suggerisce l'**ora di uscita anticipata** in base al credito ore

### ğŸ”’ Privacy assoluta
- **Zero cloud**: i dati non lasciano MAI il tuo dispositivo
- **Nessun tracciamento**: no analytics, no cookies di terze parti
- **Open source**: codice verificabile da chiunque

### ğŸ“´ Funziona offline
- **Installabile come app nativa** su smartphone e desktop
- **Funziona senza internet** â€” perfetto in ufficio senza Wi-Fi
- **Si aggiorna automaticamente** quando torni online

### ğŸ“¤ Export dati
- **JSON**: backup completo, reimportabile nell'app
- **CSV/Excel**: per elaborazioni e report
- **Nessun backup cloud**: scarichi tu il file quando vuoi

---

## ğŸ” I tuoi dati sono tuoi

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ğŸ“± IL TUO DISPOSITIVO                  â”‚
â”‚                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ localStorage  â”‚    â”‚     IndexedDB        â”‚    â”‚
â”‚   â”‚  (Primario)   â”‚    â”‚    (Fallback)        â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                     â”‚
â”‚   âœ… Dati salvati SOLO qui                          â”‚
â”‚   âœ… Nessun server esterno                          â”‚
â”‚   âœ… Nessun account richiesto                       â”‚
â”‚   âœ… Export manuale quando vuoi                     â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         âœ• NESSUN DATO ESCE
```

> âš ï¸ **Nota iOS**: Safari puÃ² eliminare i dati PWA dopo 7 giorni di inutilizzo.  
> Apri l'app almeno 1 volta a settimana o esporta periodicamente con "Esporta Backup JSON".

---

## ğŸš€ Inizia subito

### Usa online (nessuna installazione)
ğŸ‘‰ **[Apri Timbra PA](https://vtvito.github.io/italian-pa-employee-attendance/)**

### Installa come app

#### ğŸ“± Android (Chrome)
1. Apri il link sopra in **Chrome**
2. Tocca **"Installa"** nel banner che appare automaticamente
3. Oppure: Menu (â‹®) â†’ **"Aggiungi a schermata Home"**

#### ğŸ iPhone / iPad (Safari o Chrome)

1. Apri il link in **Safari** o **Chrome**
2. Tocca **Condividi**: Safari â†’ icona â¬†ï¸ in basso; Chrome â†’ menu **â‹¯** poi "Condividi"
3. Scegli **"Aggiungi a Home"** â•
4. Tocca **"Aggiungi"** in alto a destra âœ…

> ğŸ’¡ L'app mostra una guida visiva animata al primo accesso da iPhone.

#### ğŸ’» Desktop (Chrome / Edge)
1. Apri il link nel browser
2. Clicca l'icona **âŠ•** nella barra indirizzi
3. Conferma "Installa"

---

## ğŸ—ï¸ Per sviluppatori

### Architettura

Pattern **MVC + Observer + Repository**, zero dipendenze:

```
js/
â”œâ”€â”€ app.js               # Bootstrap, SW registration, update flow
â”œâ”€â”€ controllers/
â”‚   â””â”€â”€ AppController.js # Orchestrazione MVC
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ TimeEntry.js     # Singola timbratura
â”‚   â””â”€â”€ WeekData.js      # Dati settimana
â”œâ”€â”€ views/
â”‚   â”œâ”€â”€ UIManager.js     # Rendering UI, toast, PWA install
â”‚   â””â”€â”€ ModalManager.js  # Modali (edit, add, confirm, clean)
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ TimeCalculator.js # Calcoli ore, pause, delta, suggerimento venerdÃ¬
â”‚   â”œâ”€â”€ WeekNavigator.js  # Navigazione settimane ISO 8601
â”‚   â””â”€â”€ ExportService.js  # Export JSON / CSV, import
â”œâ”€â”€ storage/
â”‚   â”œâ”€â”€ StorageManager.js     # Repository pattern, dual storage
â”‚   â”œâ”€â”€ LocalStorageAdapter.js
â”‚   â””â”€â”€ IndexedDBAdapter.js
â””â”€â”€ utils/
    â”œâ”€â”€ EventBus.js      # Pub/Sub con eventi tipizzati
    â”œâ”€â”€ DateUtils.js     # ISO 8601, formatting, parsing
    â””â”€â”€ Validators.js    # Validazione orari
```

### Stack tecnologico

| Layer | Tecnologia |
|---|---|
| Linguaggio | Vanilla JavaScript ES6+ â€” no framework, no bundler |
| Moduli | ES Modules nativi (`<script type="module">`) |
| Stile | Single CSS file, variabili CSS custom, design iOS-inspired |
| Storage | localStorage (primario) + IndexedDB (fallback) |
| Offline | Service Worker con pre-cache + stale-while-revalidate |
| Manifesto | `manifest.json` â€” PWA standalone con shortcuts |
| Icone | SVG con linear gradient (192px, 512px) |

### Sviluppo locale

```bash
git clone https://github.com/VTvito/italian-pa-employee-attendance.git
cd italian-pa-employee-attendance

# Avvia server locale
python -m http.server 8000
# Apri http://localhost:8000
```

### Test

```bash
# Apri nel browser
http://localhost:8000/tests/
```

---

## ğŸ“‹ Configurazione

Le costanti sono in [`js/services/TimeCalculator.js`](js/services/TimeCalculator.js):

```javascript
export const CONFIG = {
    WEEKLY_TARGET_HOURS: 36,        // Ore settimanali target PA
    PAUSE_MINUTES: 30,              // Pausa minima obbligatoria
    PAUSE_THRESHOLD_HOURS: 6,       // Soglia per applicare pausa (tutti i giorni)
    SMART_HOURS_DEFAULT: 7.5,       // Smart working Lunâ€“Gio
    SMART_HOURS_FRIDAY: 6,          // Smart working VenerdÃ¬
    DAILY_TARGET_HOURS: 7.5,        // Target Lunâ€“Gio
    FRIDAY_TARGET_HOURS: 6          // Target VenerdÃ¬
};
// Verifica: 7.5Ã—4 + 6 = 36h âœ“
```

---

## ğŸŒ Self-hosting

### GitHub Pages (gratuito)
GiÃ  configurato â€” basta abilitare Pages nelle impostazioni del repo.

### Netlify / Vercel / Cloudflare Pages
Collega il repo e deploya automaticamente. Non servono build step.

### Docker
```dockerfile
FROM nginx:alpine
COPY . /usr/share/nginx/html
EXPOSE 80
```

---

## ğŸ¤ Contribuisci

Le Pull Request sono benvenute! Per modifiche importanti, apri prima una Issue.

1. Fork del repository
2. Crea un branch (`git checkout -b feature/nuova-funzione`)
3. Commit (`git commit -am 'Aggiunge nuova funzione'`)
4. Push (`git push origin feature/nuova-funzione`)
5. Apri una Pull Request

---

## ğŸ“„ Licenza

Distribuito sotto licenza **MIT** â€” vedi [LICENSE](LICENSE).

---

## ğŸ‘¤ Autore

**VTvito** â€” [@VTvito](https://github.com/VTvito)

---

<p align="center">
  <strong>â­ Se ti Ã¨ utile, lascia una stella! â­</strong>
</p>
